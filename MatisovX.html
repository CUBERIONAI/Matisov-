<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Matisov X — Cyber Samurai</title>

<script src="https://telegram.org/js/telegram-web-app.js"></script>
<script src="https://cdn.tailwindcss.com"></script>

<style>
@import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&display=swap');

/* ================= ROOT ================= */
:root{
  --neon:#00d2ff;
  --bg:#02040a;
}

/* ================= BASE ================= */
body{
  margin:0;
  background:radial-gradient(circle at 50% 30%, #0b2a44, var(--bg));
  color:#fff;
  font-family:'Orbitron',sans-serif;
  overflow:hidden;
}

/* ================= SCENE ================= */
.viewport{
  position:relative;
  height:60vh;
  overflow:hidden;
}

.cyber-floor{
  position:absolute;
  bottom:-60%;
  left:-50%;
  width:200%;
  height:200%;
  background:
    linear-gradient(var(--neon) 1px, transparent 1px),
    linear-gradient(90deg,var(--neon) 1px, transparent 1px);
  background-size:80px 80px;
  opacity:.15;
  transform:rotateX(70deg);
}

.hero-wrap{
  position:absolute;
  bottom:6%;
  left:50%;
  transform:translateX(-50%);
  filter:drop-shadow(0 0 40px var(--neon));
}

#hero{
  height:52vh;
  transition:transform .12s ease;
  animation:idle 3s ease-in-out infinite;
}

@keyframes idle{
  0%,100%{transform:translateY(0)}
  50%{transform:translateY(-12px)}
}

/* ================= FX ================= */
.tap-text{
  position:absolute;
  font-size:2.2rem;
  font-weight:900;
  color:var(--neon);
  pointer-events:none;
  animation:float .6s forwards;
  text-shadow:0 0 20px var(--neon);
}

@keyframes float{
  to{transform:translateY(-200px) scale(1.6);opacity:0}
}

.spark{
  position:absolute;
  width:5px;
  height:5px;
  background:var(--neon);
  border-radius:50%;
  box-shadow:0 0 10px var(--neon);
  pointer-events:none;
}

/* ================= MENU ================= */
.menu-panel{
  position:absolute;
  top:10%;
  left:50%;
  transform:translateX(-50%);
  width:90%;
  max-width:400px;
  background:rgba(10,10,20,0.9);
  backdrop-filter:blur(15px);
  border-radius:2rem;
  border:1px solid rgba(255,255,255,0.1);
  padding:1.5rem;
  display:none;
  flex-direction:column;
  z-index:100;
}

.menu-header{
  font-size:1.5rem;
  font-weight:900;
  text-align:center;
  margin-bottom:1rem;
}

.upgrade-row{
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin-bottom:.8rem;
}

.upgrade-row button{
  background:rgba(0,210,255,0.15);
  border:none;
  padding:.5rem 1rem;
  border-radius:.8rem;
  font-weight:700;
}

.close-menu{
  position:absolute;
  top:.8rem;
  right:.8rem;
  background:rgba(255,255,255,.1);
  border:none;
  border-radius:50%;
  width:30px;
  height:30px;
  font-weight:900;
}
</style>
</head>

<body>

<header class="p-6 flex justify-between items-center">
  <div class="text-2xl font-black">Matisov X</div>
  <div class="px-4 py-1 border border-blue-400/40 rounded-full text-xs">
    STAGE 1
  </div>
</header>

<main class="viewport" id="tapZone">
  <div class="cyber-floor"></div>
  <div class="hero-wrap">
    <img id="hero" src="https://raw.githubusercontent.com/CUBERIONAI/Matisov-X/main/file_0000000008b471f48ebdb6f35b1b1a5a.png">
  </div>
</main>

<!-- ENERGY -->
<div class="px-6 -mt-10">
  <div class="bg-black/60 backdrop-blur-xl rounded-3xl p-5 border border-white/10">
    <div class="flex justify-between text-xs mb-2">
      <span>⚡ Energy</span>
      <span id="energyText">100 / 100</span>
    </div>
    <div class="h-3 bg-black rounded-full overflow-hidden">
      <div id="energyBar" class="h-full bg-gradient-to-r from-cyan-400 to-blue-600"></div>
    </div>
  </div>
</div>

<!-- BALANCE -->
<div class="px-6 mt-4 text-xl font-bold flex justify-between items-center">
  <span>Balance:</span>
  <span id="bal">0</span>
</div>

<!-- MENU -->
<div class="menu-panel" id="upgradeMenu">
  <button class="close-menu" id="closeMenu">X</button>

  <div class="menu-header">MENU</div>

  <div class="upgrade-row">
    <span>Tap Power</span>
    <button id="upgradeTap">Upgrade</button>
  </div>

  <div class="upgrade-row">
    <span>Energy Cap</span>
    <button id="upgradeEnergy">Upgrade</button>
  </div>

  <hr class="my-3 opacity-20">

  <div class="upgrade-row">
    <span>Telegram Channel</span>
    <button data-key="tg">+3M</button>
  </div>

  <div class="upgrade-row">
    <span>Telegram Chat</span>
    <button data-key="chat">+2M</button>
  </div>

  <div class="upgrade-row">
    <span>YouTube</span>
    <button data-key="yt">+2M</button>
  </div>

  <div class="upgrade-row">
    <span>Instagram</span>
    <button data-key="ig">+1M</button>
  </div>

  <div class="upgrade-row">
    <span>X (Twitter)</span>
    <button data-key="x">+2M</button>
  </div>
</div>

<div class="px-6 mt-4">
  <button id="menuBtn" class="px-4 py-2 rounded-2xl bg-blue-700 font-bold">
    Menu
  </button>
</div>

<script>
Telegram.WebApp.expand();

/* ================= CONFIG ================= */
const cfg = {
  tapPower: 1,
  maxEnergy: 100,
  regen: 3
};

/* ================= STATE ================= */
let st = {
  bal: parseInt(localStorage.getItem('mx_bal')) || 0,
  e: cfg.maxEnergy,
  tapLvl: parseInt(localStorage.getItem('tapLvl')) || 1,
  energyLvl: parseInt(localStorage.getItem('energyLvl')) || 1,
  rewards: JSON.parse(localStorage.getItem('mx_rewards')) || {}
};

/* ================= NODES ================= */
const hero = document.getElementById('hero');
const zone = document.getElementById('tapZone');
const bal = document.getElementById('bal');
const energyText = document.getElementById('energyText');
const energyBar = document.getElementById('energyBar');
const menu = document.getElementById('upgradeMenu');

/* ================= TAP ================= */
zone.addEventListener('touchstart', tap, {passive:false});
zone.addEventListener('mousedown', tap);

function tap(e){
  e.preventDefault();
  if(st.e < cfg.tapPower) return;

  let x = e.touches ? e.touches[0].clientX : e.clientX;
  let y = e.touches ? e.touches[0].clientY : e.clientY;

  st.bal += cfg.tapPower;
  st.e -= cfg.tapPower;

  hero.style.transform = "scale(.9) rotate(-3deg)";
  setTimeout(()=>hero.style.transform="",120);

  const txt = document.createElement('div');
  txt.className = 'tap-text';
  txt.style.left = x+'px';
  txt.style.top = y+'px';
  txt.textContent = '+'+cfg.tapPower+' MX';
  document.body.appendChild(txt);
  setTimeout(()=>txt.remove(),600);

  updateUI();
  save();
}

/* ================= ENERGY ================= */
setInterval(()=>{
  if(st.e < cfg.maxEnergy){
    st.e = Math.min(cfg.maxEnergy, st.e + cfg.regen);
    updateUI();
  }
},1000);

/* ================= UPGRADES ================= */
upgradeTap.onclick = ()=>{
  let cost = st.tapLvl < 3 ? st.tapLvl * 100 : st.tapLvl * 1000000;
  if(st.bal >= cost){
    st.bal -= cost;
    st.tapLvl++;
    cfg.tapPower++;
    save();
    updateUI();
  }
};

upgradeEnergy.onclick = ()=>{
  let cost = st.energyLvl < 3 ? st.energyLvl * 200 : st.energyLvl * 1000000;
  if(st.bal >= cost){
    st.bal -= cost;
    st.energyLvl++;
    cfg.maxEnergy += 20;
    st.e = cfg.maxEnergy;
    save();
    updateUI();
  }
};

/* ================= SUBSCRIPTIONS ================= */
const links = {
  tg: ["https://t.me/Matisov_X", 3000000],
  chat: ["https://t.me/MatisovX", 2000000],
  yt: ["https://youtube.com/@MatisovX", 2000000],
  ig: ["https://instagram.com/matisov.x", 1000000],
  x: ["https://x.com/matisovx", 2000000]
};

document.querySelectorAll('[data-key]').forEach(btn=>{
  btn.onclick = ()=>{
    const key = btn.dataset.key;
    if(st.rewards[key]) return alert("Already claimed");
    window.open(links[key][0], "_blank");
    st.rewards[key] = true;
    st.bal += links[key][1];
    save();
    updateUI();
  };
});

/* ================= MENU ================= */
menuBtn.onclick = ()=>menu.style.display='flex';
closeMenu.onclick = ()=>menu.style.display='none';

/* ================= SAVE & UI ================= */
function save(){
  localStorage.setItem('mx_bal', st.bal);
  localStorage.setItem('tapLvl', st.tapLvl);
  localStorage.setItem('energyLvl', st.energyLvl);
  localStorage.setItem('mx_rewards', JSON.stringify(st.rewards));
}

function updateUI(){
  bal.textContent = st.bal.toLocaleString();
  energyText.textContent = `${st.e} / ${cfg.maxEnergy}`;
  energyBar.style.width = (st.e / cfg.maxEnergy * 100) + '%';
}

updateUI();
</script>

</body>
</html>
