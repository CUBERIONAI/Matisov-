<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Matisov X | Cyber Samurai</title>
<script src="https://telegram.org/js/telegram-web-app.js"></script>
<script src="https://cdn.tailwindcss.com"></script>
<style>
@import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&display=swap');

:root {
    --neon-blue: #00d2ff;
    --dark-bg: #020205;
}

body { 
    background: var(--dark-bg); 
    color: white; 
    font-family: 'Orbitron', sans-serif; 
    overflow: hidden; 
    user-select: none; 
    margin:0; 
}

/* 3D –°–¶–ï–ù–ê –¢–ê –Ü–ù–¢–ï–†'–Ñ–† */
.game-scene {
    position: relative;
    width: 100%;
    height: 55vh;
    perspective: 1000px;
    display: flex;
    justify-content: center;
    align-items: center;
    background: radial-gradient(circle at 50% 40%, #0a192f 0%, #020205 100%);
}

.floor-3d {
    position: absolute;
    bottom: 0;
    width: 200%;
    height: 100%;
    background-image: 
        linear-gradient(rgba(0, 210, 255, 0.15) 1px, transparent 1px),
        linear-gradient(90deg, rgba(0, 210, 255, 0.15) 1px, transparent 1px);
    background-size: 60px 60px;
    transform: rotateX(70deg) translateY(50%);
    mask-image: linear-gradient(to top, rgba(0,0,0,1) 20%, transparent 80%);
    z-index: 1;
}

.samurai-box {
    position: relative;
    z-index: 2;
    filter: drop-shadow(0 0 25px rgba(0, 210, 255, 0.4));
}

#samurai {
    max-height: 45vh;
    /* –í–∏–¥–∞–ª–µ–Ω–Ω—è –∑–∞–ª–∏—à–∫—ñ–≤ —Å—ñ—Ç–∫–∏ —á–µ—Ä–µ–∑ –∑–º—ñ—à—É–≤–∞–Ω–Ω—è, —è–∫—â–æ –≤–æ–Ω–∏ —î */
    mix-blend-mode: screen; 
    display: block;
    transition: transform 0.1s cubic-bezier(0.175, 0.885, 0.32, 1.275);
}

/* UI –ï–õ–ï–ú–ï–ù–¢–ò */
.mx-popup {
    position: absolute; 
    color: var(--neon-blue); 
    font-weight: 900; 
    font-size: 38px;
    pointer-events: none; 
    animation: floatUp 0.6s ease-out forwards; 
    z-index: 100;
    text-shadow: 0 0 15px var(--neon-blue);
}

@keyframes floatUp { 
    0% { transform: translateY(0) scale(1); opacity: 1; } 
    100% { transform: translateY(-180px) scale(1.5); opacity: 0; } 
}

.energy-container {
    background: rgba(255, 255, 255, 0.03);
    border: 1px solid rgba(0, 210, 255, 0.2);
    border-radius: 20px;
    padding: 15px;
    backdrop-filter: blur(10px);
}

.energy-bar { 
    height: 14px; 
    background: #080808; 
    border-radius: 7px; 
    border: 1px solid #1a1a1a; 
    overflow: hidden;
    position: relative;
}

.energy-fill { 
    height: 100%; 
    background: linear-gradient(90deg, #00d2ff, #0055ff); 
    transition: width 0.3s ease; 
    box-shadow: 0 0 20px var(--neon-blue);
}

.nav-btn.active { color: var(--neon-blue); filter: drop-shadow(0 0 8px var(--neon-blue)); }
.screen { display: none; height: calc(100vh - 220px); overflow-y: auto; }
.active-screen { display: block; }

header {
    border-bottom: 1px solid rgba(255,255,255,0.05);
    padding-bottom: 10px;
}
</style>
</head>
<body class="flex flex-col h-screen p-4">

<audio id="sfx-hit" src="https://assets.mixkit.co/active_storage/sfx/1077/1077-preview.mp3"></audio>

<header class="flex justify-between items-end mb-2">
    <div>
        <p class="text-[10px] text-gray-500 uppercase tracking-widest">Global Balance</p>
        <div class="flex items-center gap-2">
            <span id="balance" class="text-4xl font-black italic tracking-tighter">0</span>
            <span class="text-blue-500 font-bold text-xl">MX</span>
        </div>
    </div>
    <div class="text-right">
        <p id="rank" class="text-xs text-blue-400 font-bold uppercase border-b border-blue-900">Stage 1</p>
        <p class="text-[9px] text-gray-600 mt-1 italic">1M MX = 1 Coin</p>
    </div>
</header>

<main class="flex-1">
    <section id="game-screen" class="screen active-screen">
        <div class="game-scene rounded-3xl overflow-hidden shadow-2xl" id="tap-target">
            <div class="floor-3d"></div>
            <div class="samurai-box">
                <img id="samurai" src="https://raw.githubusercontent.com/CUBERIONAI/Matisov-X/main/1770305168681.png" alt="Samurai">
            </div>
        </div>

        <div class="mt-6 energy-container">
            <div class="flex justify-between text-[11px] mb-2 font-black tracking-widest text-blue-300">
                <span>‚ö° CORE ENERGY</span>
                <span id="energy-text">1000/1000</span>
            </div>
            <div class="energy-bar">
                <div id="energy-fill" class="energy-fill" style="width: 100%"></div>
            </div>
        </div>
    </section>

    <section id="tasks-screen" class="screen p-2">
        <h2 class="text-xl font-bold mb-4 text-blue-400">Cyber Missions</h2>
        <div id="task-list" class="space-y-3"></div>
    </section>
</main>

<footer class="h-20 bg-[#0d0d12] border border-white/5 rounded-3xl flex justify-around items-center mb-2 shadow-inner">
    <button onclick="nav('game')" class="nav-btn active flex flex-col items-center transition-all">
        <span class="text-2xl">‚öîÔ∏è</span><span class="text-[10px] font-bold mt-1">BATTLE</span>
    </button>
    <button onclick="nav('tasks')" class="nav-btn flex flex-col items-center transition-all">
        <span class="text-2xl">üéÅ</span><span class="text-[10px] font-bold mt-1">DATA</span>
    </button>
    <button class="nav-btn flex flex-col items-center opacity-30">
        <span class="text-2xl">üë•</span><span class="text-[10px] font-bold mt-1">NODES</span>
    </button>
</footer>

<script>
const tg = window.Telegram.WebApp;
tg.expand();
tg.backgroundColor = '#020205';
tg.headerColor = '#020205';

let balance = parseInt(localStorage.getItem('mx_bal')) || 0;
let energy = 1000;
let tapPower = 5; // –ó–±—ñ–ª—å—à–∏–≤ –¥–ª—è —Ç–µ—Å—Ç—É

const samuraiFrames = [
    "https://raw.githubusercontent.com/CUBERIONAI/Matisov-X/main/1770305168681.png",
    "https://raw.githubusercontent.com/CUBERIONAI/Matisov-X/main/1770305191748.png",
    "https://raw.githubusercontent.com/CUBERIONAI/Matisov-X/main/1770305246186.png",
    "https://raw.githubusercontent.com/CUBERIONAI/Matisov-X/main/1770305263574.png"
];

let frameIndex = 0;
const samurai = document.getElementById('samurai');
const tapTarget = document.getElementById('tap-target');
const sfxHit = document.getElementById('sfx-hit');

tapTarget.addEventListener('touchstart', (e) => {
    e.preventDefault();
    if (energy >= tapPower) {
        const touch = e.touches[0];
        const rect = tapTarget.getBoundingClientRect();

        balance += tapPower;
        energy -= tapPower;

        // –ê–Ω—ñ–º–∞—Ü—ñ—è –∫–∞–¥—Ä—É
        frameIndex = (frameIndex + 1) % samuraiFrames.length;
        samurai.src = samuraiFrames[frameIndex];
        
        // 3D –µ—Ñ–µ–∫—Ç "–≤—ñ–¥–¥–∞—á—ñ" –ø—Ä–∏ —É–¥–∞—Ä—ñ
        samurai.style.transform = "scale(0.95) translateZ(-50px)"; 
        setTimeout(() => samurai.style.transform = "scale(1) translateZ(0)", 80);

        sfxHit.currentTime = 0;
        sfxHit.play();

        showPopup(touch.clientX, touch.clientY);

        if(tg.HapticFeedback) tg.HapticFeedback.impactOccurred('heavy');
        updateUI();
        save();
    }
});

function showPopup(x, y) {
    const p = document.createElement('div');
    p.className = 'mx-popup';
    p.style.left = x + 'px'; p.style.top = y + 'px';
    p.innerText = `+${tapPower}`;
    document.body.appendChild(p);
    setTimeout(() => p.remove(), 600);
}

function updateUI() {
    document.getElementById('balance').innerText = balance.toLocaleString();
    document.getElementById('energy-text').innerText = `${energy}/1000`;
    document.getElementById('energy-fill').style.width = (energy/10) + '%';
    
    const rank = document.getElementById('rank');
    if(balance >= 10000000) rank.innerText = "Stage 3 (Shogun)";
    else if(balance >= 1000000) rank.innerText = "Stage 2 (Samurai)";
}

// –ú—ñ—Å—ñ—ó
const missions = [
    { n: "TG System Link", r: 1000000, l: "https://t.me/Matisov_X" },
    { n: "Neural Network YT", r: 1000000, l: "https://www.youtube.com/@MatisovX" }
];

function initTasks() {
    const list = document.getElementById('task-list');
    missions.forEach(m => {
        list.innerHTML += `
        <div class="bg-[#0a0a0f] p-4 rounded-2xl flex justify-between items-center border border-white/5 shadow-lg">
            <div><p class="text-sm font-bold tracking-wide">${m.n}</p><p class="text-[10px] text-blue-400">+1,000,000 MX</p></div>
            <button onclick="doTask('${m.l}', ${m.r})" class="bg-blue-600 hover:bg-blue-500 px-5 py-2 rounded-xl text-[10px] font-black uppercase transition-colors shadow-lg shadow-blue-900/20">Execute</button>
        </div>`;
    });
}

function doTask(url, reward) {
    window.open(url, '_blank');
    setTimeout(() => {
        balance += reward;
        updateUI();
        save();
        tg.showAlert("Data Decrypted! +1,000,000 MX");
    }, 3000);
}

function nav(id) {
    document.querySelectorAll('.screen').forEach(s => s.classList.remove('active-screen'));
    document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
    document.getElementById(id + '-screen').classList.add('active-screen');
    event.currentTarget.classList.add('active');
}

function save() { 
    localStorage.setItem('mx_bal', balance); 
    localStorage.setItem('mx_time', Date.now()); 
}

setInterval(() => { 
    if(energy < 1000) { 
        energy = Math.min(1000, energy + 3); 
        updateUI(); 
    } 
}, 1000);

initTasks();
updateUI();
</script>
</body>
</html>
